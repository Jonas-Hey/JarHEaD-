== Reporting ==

A report accounts and presents information about a particular subject, situation, or event. The reporting functionality provides the data in a more graphical manner, and organizes data views from a single point.

This includes exporting the views to document files, such as PDFs, which can be managed from the platform itself on the click of a button. Moreover, the report document generation can also be scheduled in order to build such documents periodically.

The reporting functionality is available as a bundled solution. See ''Installation'' section below for further details.

=== Conceptual Overview ===

To clearly identify the life cycle of the reports, the concepts "Report Template", "Report" and "Report Document" are introduced.

==== Report Template ====

A report template consists of a wiki page containing placeholders to be replaced, together with some metadata specifying the parameters required to populate such placeholders.

From the report templates, parameterized reports are generated. That is, a report template models a view of the data, but uses some placeholders along the wiki page which will be replaced by values specified at runtime, when a report is generated out of it.

==== Report ====

A report is a wiki page showing some information using the different components (tables, text, charts, etc.) that the platform provides. Reports also include metadata in order to provide extra information about them, such as the creation date and the period considered in the report or related files.

From the reports, report documents can be generated in order to export the data view at a given moment to document files.

==== Report Document ====

A report document is a snapshot of a report in a printable format. It represents a file generated out of a report, including its metadata, which provides basic information about the generated file. For example, a PDF version of a report, with information of its creation date, file size, etc.

Report documents can be downloaded and managed directly from the platform.

<br>

A report template can generate more than one report, whereas a report can be exported multiple times generating various report documents. Note that a report does not have to be generated by a report template, but can be created directly.

In the metadata, the link between report templates and the reports that each of them generates is preserved. In this way, it is easy to navigate between the different objects and track which report files belong to which view or which report template generated a given report.

=== Installation ===

The reporting functionality is provided as a bundled app. If not yet done, install the reporting app directly from the [[Admin:Apps| apps management page]].

To enable exporting report documents as PDFs, the external open source (LGPLv3) tool [http://wkhtmltopdf.org/ wkhtmltopdf] needs to be installed in the system where {{PRODUCT}} resides. The [[Setup:Reporting|Reporting Setup Page]] gives details about the installation and guides you through the configuration. Finally, it provides a testing functionality to verify that the installation was successful.


=== Report Management ===

To make report management easier, the reports and associated actions are shown and administrated from a single point on the [[http://www.fluidops.com/report/Report | Report page]].

==== Reports Overview ====

On the [[http://www.fluidops.com/report/Report | Report page]], an overview of existing reports together with their metadata (including a report description and the number of exported report documents).

Additionally, the following report management actions are included in this page:
* Create new report
* Remove reports and generated report documents
* Generate report documents

==== Create Reports ====

Creating a new report can be done from the [[http://www.fluidops.com/report/Report | Report page]] and clicking the "New Report" button. To create the report a name and a description needs to be provided.

A URI in the Report Runtime namespace will be generated based on the introduced name.

Alternatively, an existing wiki page can be marked as a Report by providing the respective metadata: in the edit view of any wiki page, the "Edit Metadata" button opens a dialog in which wiki page metadata can be adjusted. To make the page a report, the "report" checkbox can be checked.

==== Remove reports ====

On the [[http://www.fluidops.com/report/Report | Report page]], from the table listing the existing reports, the reports can be removed. They can be deleted by either selecting the reports and clicking the button "Remove Reports" underneath the table, or clicking on the remove icon at the right of each row to remove a single report.

After clicking the remove report button, a check box is presented allowing the selection of whether the generated report documents will also be removed. If checked, all the report document files and their metadata will also be removed. Otherwise, just the report and its references will be removed, but the files will remain in the system.

==== Export reports ====

Exporting a report will generate a report document, i.e., a downloadable PDF file representing a snapshot of the wiki page at a certain point in time. On the [[http://www.fluidops.com/report/Report | Report page]] the reports can be exported by clicking the export icon. After a name for the report document is provided, the report is generated as a file in the [[Help:Upload | CMS]] functionality of {{PRODUCT}}.

The generated reports can be browsed by following the report link in the first table on the [[http://www.fluidops.com/report/Report | Report page]].


==== Scheduling report generation ====

Report documents can be generated periodically using the [[Help:Tasks| Recurring Task]] functionality. In order to do so, a ''Report Task'' can be configured by providing the required information (including the report to generate, the output configuration and the scheduling configuration) as illustrated below. The configuration below will generate a storage report daily at 0:00 and store the PDF in ''data/upload/reports/Storage-Report-%TIMESTAMP%.pdf''.

<img src="../images/help/report/ReportTask-Schedule.png" style="width: 700px"/>

After creating the report, it is possible to automatically send the generated report document via email by configuring the ''Email Config'' section in the task configuration (see below). The following parameters can be set:
{{#widget: com.fluidops.iwb.widget.DisplayConfigurationWidget
| clazz = com.fluidops.iwb.provider.config.EMailConfig
}}

Note that you can use the parameter placeholder '''$reportLink$''' in the e-mail subject or body. 
This placeholder will be replaced with the URL link to the generated report file stored in the system. 

<img src="../images/help/report/ReportTask-EMailConfig.png" style="width: 700px"/>

=== Use Case Example: scheduling all customer reports ===

The following section describes an example scenario where the reporting functionality is used to generate storage reports. Though this scenario is simplified for illustration purposes, it captures the capabilities for real world environments and the configuration can be adjusted to the available managed reports and their metadata.

Suppose you manage the storages of some customers and you want to generate daily report documents (i.e., PDFs). In our example we have the customers ''Mueller AG'' and ''Meyer GmbH''. For these customers we have defined reports about their storage capacity.

The goals of this use case is to generate for all available customers a storage report. This can be achieved by combining the functionality of the report task described above with the [[Help:TriggerTask]]. The central idea is to configure the report task as ''external'' (i.e. as parameterized task), while the trigger task invokes the report task for each report identified by a query.

In our use case we identify customer reports by the ''rdf:type'' '':CustomerReport'', and in addition we have added metadata for the storage folder in the property '':customerFolder''. The following figures illustrate the required configuration. When creating the report task, the triggering conditions can be configured immediately: the parameters of the trigger task can be accessed after enabling the ''Advanced'' configuration parameters. In our example below, the query retrieves the customer reports together with other relevant information such as the customer name, customer-specific storage folder, and the e-mail address to send the report. These results retrieved by the query can then be used in the configuration of the report task: in our case, the name of the reporting file will start with the name of the customer and will be stored in the customer-specific subfolder. When the property of the report task should take the value returned by the triggering query, it is referenced using the percent-sign ''%'' and the name of the variable from the query (e.g., ''%name'' and ''%customerFolder'' below).

<img src="../images/help/report/ReportTask-TriggerConfig.png" style="width: 600px"/>

In the same way, the triggering query results can be used to specify the e-mail message to be sent together with the generated report. Note that you can use the ''Parameters'' field of the e-mail config to use the values returned by the query inside the subject and/or text of the e-mail message.

<img src="../images/help/report/ReportTask-EMailConfigWithParameters.png" style="width: 600px"/>


Once the report trigger task has been executed, the generated PDF document can be obtained from the details page of the respective report (e.g. as illustrated below for the customer ''Mueller AG'').

<img src="../images/help/report/ReportDetails.png" style="width: 900px"/>

=== Tutorial ===
See also [[Help:ReportingTutorial]] for a step by step instruction for a use case example, in which custom VM reports are sent to responsible persons.